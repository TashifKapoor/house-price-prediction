# -*- coding: utf-8 -*-
"""Untitled14.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1DnHeFnYVvQ11jQPEhH3l7R4Kn6VGCgm4
"""

import pandas as pd
import numpy as np

df = pd.read_csv("/content/HousePricePrediction.xlsx - Sheet1.csv")

df.head()

df.tail()

df.info()

df.describe()

df.shape

df.size

df.isnull().sum()

df.columns

df.duplicated()

df.nunique()

df.drop(['Id'],axis=1,inplace=True)

df['SalePrice'] = df['SalePrice'].fillna(
df['SalePrice'].mean())

new_df = df.dropna()

new_df.isnull().sum()

from sklearn import preprocessing

label_encoder = preprocessing.LabelEncoder()
new_df['MSZoning']= label_encoder.fit_transform(new_df['MSZoning'])
new_df['MSZoning'].unique()

label_encoder = preprocessing.LabelEncoder()
new_df['LotConfig']= label_encoder.fit_transform(new_df['LotConfig'])
new_df['LotConfig'].unique()

label_encoder = preprocessing.LabelEncoder()
new_df['BldgType']= label_encoder.fit_transform(new_df['BldgType'])
new_df['BldgType'].unique()

label_encoder = preprocessing.LabelEncoder()
new_df['Exterior1st']= label_encoder.fit_transform(new_df['Exterior1st'])
new_df['Exterior1st'].unique()

from sklearn.model_selection import train_test_split

X = new_df.drop(['SalePrice'], axis=1)
Y = new_df['SalePrice']

X_train, X_test, Y_train, Y_test = train_test_split(X, Y, train_size=0.8, test_size=0.2, random_state=42)

from sklearn.ensemble import RandomForestRegressor

model_RFR = RandomForestRegressor(n_estimators=10)
model_RFR.fit(X_train, Y_train)

Y_pred = model_RFR.predict(X_test)
print(Y_pred)



from sklearn.metrics import mean_absolute_percentage_error

mean_absolute_percentage_error(Y_valid, Y_pred)

